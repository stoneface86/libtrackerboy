<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="https://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>libtrackerboy/apu</title>

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- CSS -->
<link rel="stylesheet" type="text/css" href="../nimdoc.out.css?v=2.0.4">

<!-- JS -->
<script type="text/javascript" src="../dochack.js?v=2.0.4"></script>
</head>
<body>
  <div class="document" id="documentId">
    <div class="container">
      <h1 class="title">libtrackerboy/apu</h1>
      <div class="row">
  <div class="three columns">
    <div class="theme-select-wrapper">
      <label for="theme-select">Theme:&nbsp;</label>
      <select id="theme-select" onchange="setTheme(this.value)">
        <option value="auto">ðŸŒ— Match OS</option>
        <option value="dark">ðŸŒ‘ Dark</option>
        <option value="light">ðŸŒ• Light</option>
      </select>
    </div>
    <div id="global-links">
      <ul class="simple">
        <li><a id="indexLink" href="../theindex.html">Index</a></li>
      </ul>
    </div>
    <div id="searchInputDiv">
      Search: <input type="search" id="searchInput" onkeyup="search()"/>
    </div>
    <div>
      Group by:
      <select onchange="groupBy(this.value)">
        <option value="section">Section</option>
        <option value="type">Type</option>
      </select>
    </div>
    <ul class="simple simple-toc" id="toc-list">
  <ul class="simple"><li><a class="reference" id="see-also_toc" href="#see-also">See also</a></li>
</ul><li>
  <a class="reference reference-toplevel" href="#6" id="56">Imports</a>
</li>
<li>
  <details open>
    <summary><a class="reference reference-toplevel" href="#7" id="57">Types</a></summary>
    <ul class="simple simple-toc-section">
      <li><a class="reference" href="#Apu" title="Apu {.requiresInit.} = object
  autostep*: uint32">Apu</a></li>

    </ul>
  </details>
</li>
<li>
  <details open>
    <summary><a class="reference reference-toplevel" href="#12" id="62">Procs</a></summary>
    <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">availableSamples
  <li><a class="reference" href="#availableSamples%2CApu" title="availableSamples(a: Apu): int">availableSamples(a: Apu): int</a></li>

</ul>
<ul class="simple nested-toc-section">channelFrequency
  <li><a class="reference" href="#channelFrequency%2CApu%2CChannelId" title="channelFrequency(a: Apu; chno: ChannelId): int">channelFrequency(a: Apu; chno: ChannelId): int</a></li>

</ul>
<ul class="simple nested-toc-section">channelMix
  <li><a class="reference" href="#channelMix%2CApu%2CChannelId" title="channelMix(a: Apu; chno: ChannelId): MixMode">channelMix(a: Apu; chno: ChannelId): MixMode</a></li>

</ul>
<ul class="simple nested-toc-section">channelVolume
  <li><a class="reference" href="#channelVolume%2CApu%2CChannelId" title="channelVolume(a: Apu; chno: ChannelId): int">channelVolume(a: Apu; chno: ChannelId): int</a></li>

</ul>
<ul class="simple nested-toc-section">initApu
  <li><a class="reference" href="#initApu%2Cint%2Cfloat" title="initApu(samplerate: int; framerate = 59.7): Apu">initApu(samplerate: int; framerate = 59.7): Apu</a></li>

</ul>
<ul class="simple nested-toc-section">readRegister
  <li><a class="reference" href="#readRegister%2CApu%2Cuint8" title="readRegister(a: var Apu; reg: uint8): uint8">readRegister(a: var Apu; reg: uint8): uint8</a></li>

</ul>
<ul class="simple nested-toc-section">removeSamples
  <li><a class="reference" href="#removeSamples%2CApu" title="removeSamples(a: var Apu)">removeSamples(a: var Apu)</a></li>

</ul>
<ul class="simple nested-toc-section">reset
  <li><a class="reference" href="#reset%2CApu" title="reset(a: var Apu)">reset(a: var Apu)</a></li>

</ul>
<ul class="simple nested-toc-section">run
  <li><a class="reference" href="#run%2CApu%2Cuint32" title="run(a: var Apu; cycles: uint32)">run(a: var Apu; cycles: uint32)</a></li>

</ul>
<ul class="simple nested-toc-section">runToFrame
  <li><a class="reference" href="#runToFrame%2CApu" title="runToFrame(a: var Apu)">runToFrame(a: var Apu)</a></li>

</ul>
<ul class="simple nested-toc-section">setBufferSize
  <li><a class="reference" href="#setBufferSize%2CApu%2Cint" title="setBufferSize(a: var Apu; samples: int)">setBufferSize(a: var Apu; samples: int)</a></li>

</ul>
<ul class="simple nested-toc-section">setFramerate
  <li><a class="reference" href="#setFramerate%2CApu%2Cfloat" title="setFramerate(a: var Apu; framerate: float)">setFramerate(a: var Apu; framerate: float)</a></li>

</ul>
<ul class="simple nested-toc-section">setSamplerate
  <li><a class="reference" href="#setSamplerate%2CApu%2Cint" title="setSamplerate(a: var Apu; samplerate: int)">setSamplerate(a: var Apu; samplerate: int)</a></li>

</ul>
<ul class="simple nested-toc-section">setVolume
  <li><a class="reference" href="#setVolume%2CApu%2Crange%5B%5D" title="setVolume(a: var Apu; gain: range[0.0'f32 .. 1.0'f32])">setVolume(a: var Apu; gain: range[0.0'f32 .. 1.0'f32])</a></li>

</ul>
<ul class="simple nested-toc-section">takeSamples
  <li><a class="reference" href="#takeSamples%2CApu%2Cseq%5BPcm%5D" title="takeSamples(a: var Apu; buf: var seq[Pcm])">takeSamples(a: var Apu; buf: var seq[Pcm])</a></li>

</ul>
<ul class="simple nested-toc-section">time
  <li><a class="reference" href="#time%2CApu" title="time(a: Apu): uint32">time(a: Apu): uint32</a></li>

</ul>
<ul class="simple nested-toc-section">writeRegister
  <li><a class="reference" href="#writeRegister%2CApu%2Cuint8%2Cuint8" title="writeRegister(a: var Apu; reg, value: uint8)">writeRegister(a: var Apu; reg, value: uint8)</a></li>

</ul>

    </ul>
  </details>
</li>
<li>
  <a class="reference reference-toplevel" href="#19" id="69">Exports</a>
</li>

</ul>

  </div>
  <div class="nine columns" id="content">
    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L1" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L1" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

    <div id="tocRoot"></div>
    
    <p class="module-desc">Game Boy APU emulation. Provides an <a class="reference internal nimdoc" title="object Apu" href="#Apu">Apu</a> object that can synthesize audio to an internal buffer when stepping for a given number of cycles. The emulated registers can be read/written to, which can be used along side a full Game Boy emulator, or to just generate audio when playing a module.
<h2><a class="toc-backref" id="see-also" href="#see-also">See also</a></h2><p><a class="reference external" href="https://gbdev.io/pandocs/Audio.html">Pan Docs</a> for details about the hardware being emulated.</p>
</p>
    <div class="section" id="6">
  <h1><a class="toc-backref" href="#6">Imports</a></h1>
  <dl class="item">
    <a class="reference external" href="common.html">common</a>, <a class="reference external" href="private/hardware.html">private/hardware</a>, <a class="reference external" href="private/synth.html">private/synth</a>
  </dl>
</div>
<div class="section" id="7">
  <h1><a class="toc-backref" href="#7">Types</a></h1>
  <dl class="item">
    <div id="Apu">
  <dt><pre><a href="apu.html#Apu"><span class="Identifier">Apu</span></a> {.<span class="Identifier">requiresInit</span>.} <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">autostep</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">uint32</span>
  </pre></dt>
  <dd>
    
    Game Boy APU emulator. Satisfies the <a class="reference external" href="./apuio.html#ApuIo">apuio: ApuIo</a> concept.<ul class="simple"><li><tt class="docutils literal"><span class="pre"><span class="Identifier">autostep</span></span></tt>: Number of cycles to execute before reading or writing to a register. Default is 16 cycles. Set this to 0 to disable.</li>
</ul>

    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L107" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L107" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

  </dl>
</div>
<div class="section" id="12">
  <h1><a class="toc-backref" href="#12">Procs</a></h1>
  <dl class="item">
    <div id="availableSamples-procs-all">
  <div id="availableSamples,Apu">
  <dt><pre><span class="Keyword">proc</span> <a href="#availableSamples%2CApu"><span class="Identifier">availableSamples</span></a><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <a href="apu.html#Apu"><span class="Identifier">Apu</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Gets the amount of samples available in the buffer. <a class="reference internal nimdoc" title="proc takeSamples(a: var Apu; buf: var seq[Pcm])" href="#takeSamples,Apu,seq[Pcm]">takeSamples</a> will take this exact amount of samples when called. 
    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L976" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L976" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="channelFrequency-procs-all">
  <div id="channelFrequency,Apu,ChannelId">
  <dt><pre><span class="Keyword">func</span> <a href="#channelFrequency%2CApu%2CChannelId"><span class="Identifier">channelFrequency</span></a><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <a href="apu.html#Apu"><span class="Identifier">Apu</span></a><span class="Other">;</span> <span class="Identifier">chno</span><span class="Other">:</span> <a href="common.html#ChannelId"><span class="Identifier">ChannelId</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Gets the current frequency setting for the channel, for diagnostic purposes. Channels 1-3 will result in a value from 0 to 2047. Channel 4 will result in the contents of its NR43 register. 
<p><strong class="examples_text">Example:</strong></p>
<pre class="listing"><span class="Keyword">var</span> <span class="Identifier">a</span> <span class="Operator">=</span> <span class="Identifier">initApu</span><span class="Punctuation">(</span><span class="DecNumber">44100</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">channelFrequency</span><span class="Punctuation">(</span><span class="Identifier">ch2</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="DecNumber">0</span></pre>
    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L1016" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L1016" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="channelMix-procs-all">
  <div id="channelMix,Apu,ChannelId">
  <dt><pre><span class="Keyword">func</span> <a href="#channelMix%2CApu%2CChannelId"><span class="Identifier">channelMix</span></a><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <a href="apu.html#Apu"><span class="Identifier">Apu</span></a><span class="Other">;</span> <span class="Identifier">chno</span><span class="Other">:</span> <a href="common.html#ChannelId"><span class="Identifier">ChannelId</span></a><span class="Other">)</span><span class="Other">:</span> <a href="private/synth.html#MixMode"><span class="Identifier">MixMode</span></a> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Gets the current mix mode for the given channel. Provided as an alternative to reading <tt class="docutils literal"><span class="pre"><span class="Identifier">ar51</span></span></tt>. 
<p><strong class="examples_text">Example:</strong></p>
<pre class="listing"><span class="Keyword">var</span> <span class="Identifier">a</span> <span class="Operator">=</span> <span class="Identifier">initApu</span><span class="Punctuation">(</span><span class="DecNumber">44100</span><span class="Punctuation">)</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">writeRegister</span><span class="Punctuation">(</span><span class="HexNumber">0x26</span><span class="Punctuation">,</span> <span class="HexNumber">0x80</span><span class="Punctuation">)</span>         <span class="Comment"># NR52 &lt;- 0x80</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">writeRegister</span><span class="Punctuation">(</span><span class="HexNumber">0x25</span><span class="Punctuation">,</span> <span class="BinNumber">0b00110101</span><span class="Punctuation">)</span>   <span class="Comment"># NR51 &lt;- 0x35</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">channelMix</span><span class="Punctuation">(</span><span class="Identifier">ch1</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="Identifier">mixMiddle</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">channelMix</span><span class="Punctuation">(</span><span class="Identifier">ch2</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="Identifier">mixRight</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">channelMix</span><span class="Punctuation">(</span><span class="Identifier">ch3</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="Identifier">mixLeft</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">channelMix</span><span class="Punctuation">(</span><span class="Identifier">ch4</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="Identifier">mixMute</span></pre>
    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L1063" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L1063" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="channelVolume-procs-all">
  <div id="channelVolume,Apu,ChannelId">
  <dt><pre><span class="Keyword">func</span> <a href="#channelVolume%2CApu%2CChannelId"><span class="Identifier">channelVolume</span></a><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <a href="apu.html#Apu"><span class="Identifier">Apu</span></a><span class="Other">;</span> <span class="Identifier">chno</span><span class="Other">:</span> <a href="common.html#ChannelId"><span class="Identifier">ChannelId</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Returns a number from 0 to 15 resprenting the current volume level of the channel. For channels with an enevelope, this level is the current volume of the envelope. For the Wave channel, this value is the maximum possible determined by the wave volume setting (NR32). 
<p><strong class="examples_text">Example:</strong></p>
<pre class="listing"><span class="Keyword">var</span> <span class="Identifier">a</span> <span class="Operator">=</span> <span class="Identifier">initApu</span><span class="Punctuation">(</span><span class="DecNumber">44100</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">channelVolume</span><span class="Punctuation">(</span><span class="Identifier">ch1</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="DecNumber">0</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">channelVolume</span><span class="Punctuation">(</span><span class="Identifier">ch3</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="DecNumber">0</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">writeRegister</span><span class="Punctuation">(</span><span class="HexNumber">0x26</span><span class="Punctuation">,</span> <span class="HexNumber">0x80</span><span class="Punctuation">)</span>  <span class="Comment"># NR52 &lt;- 0x80</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">writeRegister</span><span class="Punctuation">(</span><span class="HexNumber">0x12</span><span class="Punctuation">,</span> <span class="HexNumber">0xD0</span><span class="Punctuation">)</span>  <span class="Comment"># NR12 &lt;- 0xD0</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">writeRegister</span><span class="Punctuation">(</span><span class="HexNumber">0x14</span><span class="Punctuation">,</span> <span class="HexNumber">0x80</span><span class="Punctuation">)</span>  <span class="Comment"># NR14 &lt;- 0x80</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">writeRegister</span><span class="Punctuation">(</span><span class="HexNumber">0x1C</span><span class="Punctuation">,</span> <span class="HexNumber">0x20</span><span class="Punctuation">)</span>  <span class="Comment"># NR32 &lt;- 0x20</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">channelVolume</span><span class="Punctuation">(</span><span class="Identifier">ch1</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="HexNumber">0xD</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">channelVolume</span><span class="Punctuation">(</span><span class="Identifier">ch3</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="HexNumber">0xF</span></pre>
    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L1030" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L1030" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="initApu-procs-all">
  <div id="initApu,int,float">
  <dt><pre><span class="Keyword">func</span> <a href="#initApu%2Cint%2Cfloat"><span class="Identifier">initApu</span></a><span class="Other">(</span><span class="Identifier">samplerate</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">;</span> <span class="Identifier">framerate</span> <span class="Other">=</span> <span class="FloatNumber">59.7</span><span class="Other">)</span><span class="Other">:</span> <a href="apu.html#Apu"><span class="Identifier">Apu</span></a> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Initializes an <a class="reference internal nimdoc" title="object Apu" href="#Apu">Apu</a> with the given samplerate and internal buffer size that contains a single frame with the given framerate. <tt class="docutils literal"><span class="pre"><span class="Identifier">samplerate</span></span></tt> and <tt class="docutils literal"><span class="pre"><span class="Identifier">framerate</span></span></tt> are in Hz and must be greater than 0.</p>
<p>The returned Apu is in its default, or hardware reset, state. The volume step is set to a default of 0.625f. </p>

<p><strong class="examples_text">Example:</strong></p>
<pre class="listing"><span class="Keyword">var</span> <span class="Identifier">a</span> <span class="Operator">=</span> <span class="Identifier">initApu</span><span class="Punctuation">(</span><span class="DecNumber">24000</span><span class="Punctuation">,</span> <span class="FloatNumber">60.0</span><span class="Punctuation">)</span> <span class="Comment"># 24000 Hz samplerate with a 60 Hz framerate</span></pre>
    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L563" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L563" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="readRegister-procs-all">
  <div id="readRegister,Apu,uint8">
  <dt><pre><span class="Keyword">func</span> <a href="#readRegister%2CApu%2Cuint8"><span class="Identifier">readRegister</span></a><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="apu.html#Apu"><span class="Identifier">Apu</span></a><span class="Other">;</span> <span class="Identifier">reg</span><span class="Other">:</span> <span class="Identifier">uint8</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">uint8</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Reads the register at address <tt class="docutils literal"><span class="pre"><span class="Identifier">reg</span></span></tt>. This proc emulates the behavior of reading the memory-mapped registers on an actual Game Boy. Since some registers are write-only (ie frequency), attempting to read these registers will result in their bits being read back as all 1s.</p>
<p><tt class="docutils literal"><span class="pre"><span class="Identifier">reg</span></span></tt> is the memory address of the register in the 0xFF00 page, so to read rNR10, 0xFF10, you would call this proc with <tt class="docutils literal"><span class="pre"><span class="Identifier">reg</span> <span class="Operator">=</span> <span class="HexNumber">0x10</span><span class="Identifier">u8</span></span></tt></p>
<p>The Apu is run for <tt class="docutils literal"><span class="pre"><span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">autostep</span></span></tt> cycles and then the read is performed.</p>
<p>The proc will return 0xFF for any invalid reg address. </p>

<p><strong class="examples_text">Example:</strong></p>
<pre class="listing"><span class="Keyword">var</span> <span class="Identifier">a</span> <span class="Operator">=</span> <span class="Identifier">initApu</span><span class="Punctuation">(</span><span class="DecNumber">44100</span><span class="Punctuation">)</span>
<span class="Comment"># sound is OFF, all reads should result in 0xFF</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">readRegister</span><span class="Punctuation">(</span><span class="HexNumber">0x10</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="HexNumber">0xFF</span><span class="Identifier">u8</span>
<span class="Comment"># NR52 should be 0x70</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">readRegister</span><span class="Punctuation">(</span><span class="HexNumber">0x26</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="HexNumber">0x70</span><span class="Identifier">u8</span></pre>
    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L728" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L728" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="removeSamples-procs-all">
  <div id="removeSamples,Apu">
  <dt><pre><span class="Keyword">proc</span> <a href="#removeSamples%2CApu"><span class="Identifier">removeSamples</span></a><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="apu.html#Apu"><span class="Identifier">Apu</span></a><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Removes all samples in the sample buffer. The Apu's sample buffer is cleared and its time is set to 0. 
    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L995" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L995" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="reset-procs-all">
  <div id="reset,Apu">
  <dt><pre><span class="Keyword">proc</span> <a href="#reset%2CApu"><span class="Identifier">reset</span></a><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="apu.html#Apu"><span class="Identifier">Apu</span></a><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Resets the apu to its initial state. Should behave similarly to a hardware reset. The internal sample buffer is also cleared. 
<p><strong class="examples_text">Example:</strong></p>
<pre class="listing"><span class="Keyword">var</span> <span class="Identifier">a</span> <span class="Operator">=</span> <span class="Identifier">initApu</span><span class="Punctuation">(</span><span class="DecNumber">44100</span><span class="Punctuation">)</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">writeRegister</span><span class="Punctuation">(</span><span class="HexNumber">0x26</span><span class="Punctuation">,</span> <span class="HexNumber">0x80</span><span class="Punctuation">)</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">writeRegister</span><span class="Punctuation">(</span><span class="HexNumber">0x12</span><span class="Punctuation">,</span> <span class="HexNumber">0xF2</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">readRegister</span><span class="Punctuation">(</span><span class="HexNumber">0x12</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="HexNumber">0xF2</span><span class="Identifier">u8</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">reset</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">readRegister</span><span class="Punctuation">(</span><span class="HexNumber">0x12</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="HexNumber">0xFF</span><span class="Identifier">u8</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">availableSamples</span> <span class="Operator">==</span> <span class="DecNumber">0</span></pre>
    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L597" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L597" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="run-procs-all">
  <div id="run,Apu,uint32">
  <dt><pre><span class="Keyword">proc</span> <a href="#run%2CApu%2Cuint32"><span class="Identifier">run</span></a><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="apu.html#Apu"><span class="Identifier">Apu</span></a><span class="Other">;</span> <span class="Identifier">cycles</span><span class="Other">:</span> <span class="Identifier">uint32</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Runs the apu for a given number of cycles. The internal sample buffer is updated with new samples from the run. Use <a class="reference internal nimdoc" title="proc takeSamples(a: var Apu; buf: var seq[Pcm])" href="#takeSamples,Apu,seq[Pcm]">takeSamples</a> afterwards to collect them for processing, or <a class="reference internal nimdoc" title="proc removeSamples(a: var Apu)" href="#removeSamples,Apu">removeSamples</a> to discard them. 
<p><strong class="examples_text">Example:</strong></p>
<pre class="listing"><span class="Keyword">var</span> <span class="Identifier">a</span> <span class="Operator">=</span> <span class="Identifier">initApu</span><span class="Punctuation">(</span><span class="DecNumber">44100</span><span class="Punctuation">,</span> <span class="FloatNumber">1.0</span><span class="Punctuation">)</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">run</span><span class="Punctuation">(</span><span class="DecNumber">4194304</span><span class="Punctuation">)</span> <span class="Comment"># 1 second</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">availableSamples</span> <span class="Operator">==</span> <span class="DecNumber">44100</span>
<span class="Comment"># another call to run will overrun the buffer</span>
<span class="Comment"># to empty the buffer do either:</span>
<span class="Comment">#  a.takeSamples(buffer)</span>
<span class="Comment">#  a.removeSamples()</span></pre>
    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L676" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L676" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="runToFrame-procs-all">
  <div id="runToFrame,Apu">
  <dt><pre><span class="Keyword">proc</span> <a href="#runToFrame%2CApu"><span class="Identifier">runToFrame</span></a><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="apu.html#Apu"><span class="Identifier">Apu</span></a><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Runs the apu for the required number of cycles to complete a frame. The amount of cycles that is run is determined by the Apu's current time and the framerate setting. 
<p><strong class="examples_text">Example:</strong></p>
<pre class="listing"><span class="Keyword">var</span> <span class="Identifier">a</span> <span class="Operator">=</span> <span class="Identifier">initApu</span><span class="Punctuation">(</span><span class="DecNumber">48000</span><span class="Punctuation">,</span> <span class="FloatNumber">60.0</span><span class="Punctuation">)</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">runToFrame</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
<span class="Comment"># there are 800 samples in a frame</span>
<span class="Comment"># and 69905.06 cycles in a frame</span>
<span class="Comment"># so we step 69905 cycles which results in 799 samples instead</span>
<span class="Comment"># (eventually there will be one frame with 800 samples)</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">availableSamples</span> <span class="Operator">==</span> <span class="DecNumber">799</span></pre>
    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L706" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L706" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="setBufferSize-procs-all">
  <div id="setBufferSize,Apu,int">
  <dt><pre><span class="Keyword">proc</span> <a href="#setBufferSize%2CApu%2Cint"><span class="Identifier">setBufferSize</span></a><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="apu.html#Apu"><span class="Identifier">Apu</span></a><span class="Other">;</span> <span class="Identifier">samples</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Sets the apu's internal buffer to the given number of samples. This will destroy the contents of the buffer so it is recommended you call <a class="reference internal nimdoc" title="proc takeSamples(a: var Apu; buf: var seq[Pcm])" href="#takeSamples,Apu,seq[Pcm]">takeSamples</a> first. 
    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L1008" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L1008" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="setFramerate-procs-all">
  <div id="setFramerate,Apu,float">
  <dt><pre><span class="Keyword">proc</span> <a href="#setFramerate%2CApu%2Cfloat"><span class="Identifier">setFramerate</span></a><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="apu.html#Apu"><span class="Identifier">Apu</span></a><span class="Other">;</span> <span class="Identifier">framerate</span><span class="Other">:</span> <span class="Identifier">float</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Changes the apu's internal buffer size to match a single frame of the given framerate. The APU must be reset when changing the framerate. 
    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L554" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L554" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="setSamplerate-procs-all">
  <div id="setSamplerate,Apu,int">
  <dt><pre><span class="Keyword">proc</span> <a href="#setSamplerate%2CApu%2Cint"><span class="Identifier">setSamplerate</span></a><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="apu.html#Apu"><span class="Identifier">Apu</span></a><span class="Other">;</span> <span class="Identifier">samplerate</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Sets the samplerate of the generated audio. The internal sample buffer is left untouched, so it is recommended you call <a class="reference internal nimdoc" title="proc takeSamples(a: var Apu; buf: var seq[Pcm])" href="#takeSamples,Apu,seq[Pcm]">takeSamples</a> or <a class="reference internal nimdoc" title="proc removeSamples(a: var Apu)" href="#removeSamples,Apu">removeSamples</a> beforehand. 
    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L1001" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L1001" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="setVolume-procs-all">
  <div id="setVolume,Apu,range[]">
  <dt><pre><span class="Keyword">proc</span> <a href="#setVolume%2CApu%2Crange%5B%5D"><span class="Identifier">setVolume</span></a><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="apu.html#Apu"><span class="Identifier">Apu</span></a><span class="Other">;</span> <span class="Identifier">gain</span><span class="Other">:</span> <span class="Identifier">range</span><span class="Other">[</span><span class="FloatNumber">0.0'f32</span> <span class="Operator">..</span> <span class="FloatNumber">1.0'f32</span><span class="Other">]</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Sets the volume level of the apu to the given linear gain value. The gain should range from 0.0f to 1.0f. The default volume level is a linear value of 0.625f or about -4 dB. 
<p><strong class="examples_text">Example:</strong></p>
<pre class="listing"><span class="Keyword">var</span> <span class="Identifier">a</span> <span class="Operator">=</span> <span class="Identifier">initApu</span><span class="Punctuation">(</span><span class="DecNumber">44100</span><span class="Punctuation">)</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">setVolume</span><span class="Punctuation">(</span><span class="FloatNumber">0.5</span><span class="Identifier">f</span><span class="Punctuation">)</span></pre>
    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L537" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L537" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="takeSamples-procs-all">
  <div id="takeSamples,Apu,seq[Pcm]">
  <dt><pre><span class="Keyword">proc</span> <a href="#takeSamples%2CApu%2Cseq%5BPcm%5D"><span class="Identifier">takeSamples</span></a><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="apu.html#Apu"><span class="Identifier">Apu</span></a><span class="Other">;</span> <span class="Identifier">buf</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">seq</span><span class="Other">[</span><a href="common.html#Pcm"><span class="Identifier">Pcm</span></a><span class="Other">]</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Takes out the entire sample buffer and puts it into the given buf. The buf's len will be set to <tt class="docutils literal"><span class="pre"><span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">availableSamples</span> <span class="Operator">*</span> <span class="DecNumber">2</span></span></tt> and will have the contents of the apu's sample buffer.</p>
<p>Afterwards, the Apu's sample buffer is cleared and its time is set to 0. </p>

    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L986" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L986" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="time-procs-all">
  <div id="time,Apu">
  <dt><pre><span class="Keyword">func</span> <a href="#time%2CApu"><span class="Identifier">time</span></a><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <a href="apu.html#Apu"><span class="Identifier">Apu</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">uint32</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Gets the apu's current time, in cycles. Calling <a class="reference internal nimdoc" title="proc takeSamples(a: var Apu; buf: var seq[Pcm])" href="#takeSamples,Apu,seq[Pcm]">takeSamples</a> or <a class="reference internal nimdoc" title="proc removeSamples(a: var Apu)" href="#removeSamples,Apu">removeSamples</a> resets the time to 0. 
<p><strong class="examples_text">Example:</strong></p>
<pre class="listing"><span class="Keyword">var</span> <span class="Identifier">a</span> <span class="Operator">=</span> <span class="Identifier">initApu</span><span class="Punctuation">(</span><span class="DecNumber">44100</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">time</span> <span class="Operator">==</span> <span class="DecNumber">0</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">run</span><span class="Punctuation">(</span><span class="DecNumber">1000</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">time</span> <span class="Operator">==</span> <span class="DecNumber">1000</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">run</span><span class="Punctuation">(</span><span class="DecNumber">100</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">time</span> <span class="Operator">==</span> <span class="DecNumber">1100</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">removeSamples</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">time</span> <span class="Operator">==</span> <span class="DecNumber">0</span>      <span class="Comment"># takeSamples will also reset time to 0</span></pre>
    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L961" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L961" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="writeRegister-procs-all">
  <div id="writeRegister,Apu,uint8,uint8">
  <dt><pre><span class="Keyword">proc</span> <a href="#writeRegister%2CApu%2Cuint8%2Cuint8"><span class="Identifier">writeRegister</span></a><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="apu.html#Apu"><span class="Identifier">Apu</span></a><span class="Other">;</span> <span class="Identifier">reg</span><span class="Other">,</span> <span class="Identifier">value</span><span class="Other">:</span> <span class="Identifier">uint8</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Writes <tt class="docutils literal"><span class="pre"><span class="Identifier">value</span></span></tt> to the apu's register at <tt class="docutils literal"><span class="pre"><span class="Identifier">reg</span></span></tt> address. Like <a class="reference internal nimdoc" title="proc readRegister(a: var Apu; reg: uint8): uint8" href="#readRegister,Apu,uint8">readRegister</a>, this proc emulates writing to the Game Boy's memory-mapped APU registers. Writes to any unknown address are ignored. Writes to read-only portions of registers are also ignored. Like <a class="reference internal nimdoc" title="proc readRegister(a: var Apu; reg: uint8): uint8" href="#readRegister,Apu,uint8">readRegister</a>, the write occurs at the apu's current <tt class="docutils literal"><span class="pre"><span class="Identifier">time</span></span></tt>, after stepping <tt class="docutils literal"><span class="pre"><span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">autostep</span></span></tt> cycles. 
<p><strong class="examples_text">Example:</strong></p>
<pre class="listing"><span class="Keyword">var</span> <span class="Identifier">a</span> <span class="Operator">=</span> <span class="Identifier">initApu</span><span class="Punctuation">(</span><span class="DecNumber">44100</span><span class="Punctuation">)</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">writeRegister</span><span class="Punctuation">(</span><span class="HexNumber">0x12</span><span class="Punctuation">,</span> <span class="HexNumber">0xC0</span><span class="Punctuation">)</span> <span class="Comment"># APU is off, write is ignored</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">writeRegister</span><span class="Punctuation">(</span><span class="HexNumber">0x26</span><span class="Punctuation">,</span> <span class="HexNumber">0x80</span><span class="Punctuation">)</span> <span class="Comment"># turn APU on</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">readRegister</span><span class="Punctuation">(</span><span class="HexNumber">0x12</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="HexNumber">0x00</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">writeRegister</span><span class="Punctuation">(</span><span class="HexNumber">0x12</span><span class="Punctuation">,</span> <span class="HexNumber">0xC0</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">readRegister</span><span class="Punctuation">(</span><span class="HexNumber">0x12</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="HexNumber">0xC0</span>
<span class="Identifier">a</span><span class="Operator">.</span><span class="Identifier">writeRegister</span><span class="Punctuation">(</span><span class="HexNumber">0xD3</span><span class="Punctuation">,</span> <span class="HexNumber">0xCC</span><span class="Punctuation">)</span> <span class="Comment"># invalid register, write is ignored</span></pre>
    <a href="https://github.com/stoneface86/libtrackerboy/tree/develop/libtrackerboy/apu.nim#L814" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/stoneface86/libtrackerboy/edit/develop/libtrackerboy/apu.nim#L814" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>

  </dl>
</div>
<div class="section" id="19">
  <h1><a class="toc-backref" href="#19">Exports</a></h1>
  <dl class="item">
    <a href="common.html#Pcm"><span class="Identifier">Pcm</span></a>, <a href="common.html#iptr"><span class="Identifier">iptr</span></a>, <a href="common.html#PositiveByte"><span class="Identifier">PositiveByte</span></a>, <a href="common.html#PcmF32"><span class="Identifier">PcmF32</span></a>, <a href="common.html#isNil.t,iref[T]"><span class="Identifier">isNil</span></a>, <a href="common.html#==.t,,iref[T]"><span class="Identifier">==</span></a>, <a href="common.html#ByteIndex"><span class="Identifier">ByteIndex</span></a>, <a href="common.html#==.t,ptr.T,iptr[T]"><span class="Identifier">==</span></a>, <a href="common.html#==.t,iref[T],ref.T"><span class="Identifier">==</span></a>, <a href="common.html#Tristate"><span class="Identifier">Tristate</span></a>, <a href="common.html#==.t,iptr[T],iptr[T]"><span class="Identifier">==</span></a>, <a href="common.html#iref"><span class="Identifier">iref</span></a>, <a href="common.html#==.t,iptr[T],ptr.T"><span class="Identifier">==</span></a>, <a href="common.html#==.t,iref[T],iref[T]"><span class="Identifier">==</span></a>, <a href="common.html#add,FixedSeq[N,T],sinkT"><span class="Identifier">add</span></a>, <a href="common.html#==.t,iref[T],"><span class="Identifier">==</span></a>, <a href="common.html#capacity.t"><span class="Identifier">capacity</span></a>, <a href="common.html#isNil.t,iptr[T]"><span class="Identifier">isNil</span></a>, <a href="common.html#ChannelId"><span class="Identifier">ChannelId</span></a>, <a href="common.html#FixedSeq"><span class="Identifier">FixedSeq</span></a>, <a href="common.html#[].t,FixedSeq[N,T],int"><span class="Identifier">[]</span></a>, <a href="common.html#==.t,ref.T,iref[T]"><span class="Identifier">==</span></a>, <a href="common.html#immutable.t,ref.T"><span class="Identifier">immutable</span></a>, <a href="common.html#==.t,,iptr[T]"><span class="Identifier">==</span></a>, <a href="common.html#==.t,iptr[T],"><span class="Identifier">==</span></a>, <a href="common.html#immutable.t,ptr.T"><span class="Identifier">immutable</span></a>, <a href="common.html#[].t,iptr[T]"><span class="Identifier">[]</span></a>, <a href="common.html#items.i,FixedSeq[N,T]"><span class="Identifier">items</span></a>, <a href="common.html#[].t,iref[T]"><span class="Identifier">[]</span></a>, <a href="private/synth.html#MixMode"><span class="Identifier">MixMode</span></a>, <a href="private/synth.html#pansLeft,MixMode"><span class="Identifier">pansLeft</span></a>, <a href="private/synth.html#pansRight,MixMode"><span class="Identifier">pansRight</span></a>
  </dl>
</div>

  </div>
</div>

      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br>
        <small style="color: var(--hint);">Made with Nim. Generated: 2024-05-27 21:34:10 UTC</small>
      </div>
    </div>
  </div>
  
  <!-- Google fonts -->
  <link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
  <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>
</body>
</html>
